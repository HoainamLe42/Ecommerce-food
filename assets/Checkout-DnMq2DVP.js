import{b as V,j as e,A as D,u as E,i as A,r as d,C as L,L as m,f as x,B as C,P as U}from"./index-CtOejRDY.js";import{C as $}from"./chevron-left-DHD5Q69K.js";/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=V("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]),h=({value:l,setValue:a,label:r,type:o,name:p})=>e.jsxs("div",{className:"relative",children:[e.jsx("label",{htmlFor:"",className:`absolute  text-sm text-secondary-text/80 left-4 transition-all duration-300 ${l?"text-xs top-[5px] text-primary":"top-[13px]"}`,children:r}),e.jsx("input",{type:o,name:p,value:l,onChange:a,className:`border-[1px] text-sm px-4 border-gray-300 h-[44px] rounded-md w-full placeholder:text-sm ${l?"pt-3":"pt-0"}`})]}),B=async l=>{try{const a=await fetch(`${D}/orders`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!a.ok)throw new Error(`Failed to submit order: ${a.status}`);return await a.json()}catch(a){throw console.error("Error submitting order: ",a),a}},_=[{id:"cod",label:"Thanh toán khi nhận hàng"},{id:"bank",label:"Chuyển khoản ngân hàng"},{id:"card",label:"Thẻ tín dụng/ghi nợ"},{id:"momo",label:"Ví MoMo"}],J=()=>{const{cartItems:l,setCartItems:a,getItemQuantity:r,getItemCartAmount:o,totalItemsInCart:p}=E(),{user:j}=A(),[b,w]=d.useState(!1),[I,f]=d.useState(!1),S=()=>f(!0),k=()=>f(!1);console.log(j);const[t,g]=d.useState({name:"",address:"",email:"",phone:"",paymentMethod:"cod"}),i=s=>{const{name:n,value:T}=s.target;g({...t,[n]:T})},M=()=>{w(!b)},[u,y]=d.useState(""),[N,v]=d.useState(!1),c=u.trim().length>5,O=()=>{c&&(v(!0),y(""))},P=s=>{if(s.preventDefault(),!t.name||!t.address||!t.paymentMethod||!t.email||!t.phone){alert("Vui lòng điền đầy đủ thông tin!");return}const n={id:Date.now(),userId:localStorage.getItem("userId")||"gust",items:l,total:o(),paymentMethod:t.paymentMethod,address:t.address,date:new Date().toISOString()};B(n),g({name:"",address:"",email:"",phone:"",paymentMethod:"cod"}),alert(JSON.stringify(n,null,2)),S(),a([])};return console.log("UserID: ",localStorage.getItem("userId")),console.log("CartItems: ",l),e.jsxs("div",{className:"bg-white h-screen",children:[e.jsx("div",{className:"h-full",children:e.jsxs(L,{children:[e.jsx(m,{to:"/",children:e.jsx("img",{src:"./logo.png",alt:"Logo",className:"lg:hidden py-3 flex mx-auto"})}),e.jsxs("form",{onSubmit:P,className:"grid lg:grid-cols-[2fr_1fr] grid-cols-1 gap-5 h-screen",children:[e.jsxs("div",{className:"lg:pt-7 pt-0",children:[e.jsx(m,{to:"/",children:e.jsx("img",{src:"./logo.png",alt:"",className:"lg:block  hidden"})}),e.jsxs("div",{className:"mt-3 flex lg:flex-row flex-col gap-5",children:[e.jsxs("div",{className:"flex flex-col flex-1",children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Thông tin nhận hàng"}),j?void 0:e.jsx(m,{to:"/sign-in",children:e.jsxs("p",{className:"flex items-center gap-2 text-sm text-primary",children:[e.jsx(F,{size:"20"}),"Đăng nhập"]})})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx(h,{label:"Họ và tên",name:"name",type:"text",value:t.name,setValue:i}),e.jsx(h,{label:"Địa chỉ",name:"address",type:"text",value:t.address,setValue:i}),e.jsx(h,{label:"Email",name:"email",type:"email",value:t.email,setValue:i}),e.jsx(h,{label:"Số điện thoại",name:"phone",type:"number",value:t.phone,setValue:i})]})]}),e.jsxs("div",{className:"flex flex-col flex-1",children:[e.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Vận chuyển"}),e.jsxs("p",{className:"flex items-center gap-2 border-[1px] text-sm font-semibold px-4 border-gray-300 h-[44px] rounded-md w-full",children:[e.jsx("span",{className:"text-secondary-text font-normal",children:"Đồng giá:"})," ",x(3e4)]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold mt-5",children:"Phương thức thanh toán"}),e.jsx("ul",{className:"mt-3 flex flex-col gap-2",children:_.map(s=>e.jsxs("li",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"radio",id:s.id,value:s.id,name:"paymentMethod",onChange:n=>g({...t,paymentMethod:n.target.value}),checked:t.paymentMethod===s.id,className:"w-4 h-4 accent-primary"}),e.jsx("label",{htmlFor:s.id,className:"text-sm cursor-pointer",children:s.label})]},s.id))})]})]})]})]}),e.jsxs("div",{className:"lg:bg-gray-100 bg-white lg:px-7 md:py-5 py-0 lg:border-[1px] border-none border-r-0 border-y-0 border-gray-300 pb-10",children:[e.jsxs("h2",{onClick:M,className:"text-xl font-semibold border-b border-gray-300 pb-3",children:["Đơn hàng (",e.jsx("span",{children:p()})," sản phẩm)"]}),e.jsx("ul",{className:`lg:flex ${b?"flex":"hidden"} flex-col mt-5`,children:l.map(s=>e.jsxs("li",{className:"flex items-center mb-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:s.image,alt:"",className:"h-[50px] w-auto object-cover rounded-md border-[1px] border-gray-300"}),e.jsx("span",{className:"absolute -top-[10%] -right-[10%] text-white bg-primary/80 h-5 w-5 flex items-center justify-center rounded-full text-xs",children:r(Number(s.id))})]}),e.jsx("p",{className:"text-sm font-semibold ml-3",children:s.name}),e.jsx("p",{className:"text-sm text-secondary-text ml-auto",children:x(r(Number(s.id))*s.price)})]},s.id))}),e.jsxs("div",{className:"py-4 mt-4 border-y border-gray-300",children:[e.jsxs("div",{className:"flex justify-between gap-4",children:[e.jsx("input",{type:"text",name:"couponCode",value:u,onChange:s=>{y(s.target.value),v(!1)},placeholder:"Nhập mã giảm giá",className:"text-sm py-2 px-3 border-[1px] border-gray-300 rounded-lg w-full"}),e.jsx(C,{onClick:O,disabled:!c,className:`px-4 py-3 text-nowrap disabled:bg-primary/70 ${c?"":"cursor-not-allowed"}`,children:"Áp dụng"})]}),N&&e.jsx("p",{className:"text-red-500 text-sm mt-2 ml-1",children:"Mã giảm giá đã được áp dụng!"}),!c&&u.trim()&&!N&&e.jsx("p",{className:"text-red-500 text-sm mt-2 ml-1",children:"Mã giảm giá phải dài hơn 5 ký tự."})]}),e.jsxs("div",{className:"mt-5",children:[e.jsxs("p",{className:"flex justify-between text-sm text-secondary-text",children:["Tạm tính"," ",e.jsx("span",{children:x(o())})]}),e.jsxs("p",{className:"mt-3 flex justify-between text-sm text-secondary-text",children:["Phí vận chuyển",e.jsx("span",{children:"---"})]}),e.jsxs("p",{className:"mt-4 pt-4 flex justify-between text-secondary-text border-t border-t-gray-300",children:["Tổng cộng",e.jsx("span",{className:"text-red-600 text-xl font-semibold",children:x(o())})]}),e.jsxs("div",{className:"mt-4 flex justify-between gap-2",children:[e.jsxs(m,{to:"/cart",className:"flex items-center text-sm text-primary",children:[e.jsx($,{size:"20"}),"Quay về giỏ hàng"]}),e.jsx(C,{type:"submit",className:"font-bold py-3 px-5",children:"ĐẶT HÀNG"})]})]})]})]})]})}),e.jsx(U,{isOpen:I,onClose:k,children:e.jsx("p",{className:"p-8",children:"Đặt hàng thành công."})})]})};export{J as default};
